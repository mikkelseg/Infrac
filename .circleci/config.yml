version: 2.1
# Use a package of configuration called an orb.
orbs:
  # Choose either one of the orbs belo
  # welcome: circleci/welcome-orb@0.4.1
  # aws-cli: circleci/aws-cli@2.0.3
# Define the jobs we want to run for this project
jobs:
 # create_infrastructure: 
  #  docker:
   #    - image: amazon/aws-cli
   # steps:
   #   - checkout
   #   - run:
    #      name: Create Cloudformation Stack
      #    command: |
      #      aws cloudformation deploy \
       #      --template-file template.yml \
         #     --stack-name myStack123
              
  # configure_infrastructure: 
  # docker: 
   #  - image: python:3.7-alpine3.11
  # steps:
   #  - checkout
   #  - add_ssh_keys:
             # You can get this ID in the section where you registered the SSH Key
           #  fingerprints: ['10:fd:c5:cb:a5:97:b3:5b:5d:bf:b1:11:00:81:09:76'] 
 #    - run:
  #      name: Install Ansible
    #    command: |
          # Install Ansible
    #      apk add --update ansible
    # - run:
     #   name: Run Playbook and Configure server
     #   command: |
          # Your command
     #     ansible-playbook -i inventory.txt main.yml 
     
    smoke_test:
    docker:
      - image: alpine:latest
    steps:
       - run: apk add --update curl
       - run:
          name: smoke test
          command: |
            URL="https://blog.udacity.com/"
            # Test if website exists
            if curl -s --head ${URL} 
            then
              return 0
            else
              return 1
            fi
   
workflows:
   # Name the workflow
   myWorkflow:
     jobs:
       #- create_infrastructure
       #- configure_infrastructure
        - smoke_test
       
       
      
